---
title: "GeoSpatialDataAnalysis"
authors: "Chance Bradford, Yuuki Matsunari"
format: html
editor: visual
---

# Geospatial Analysis of Frequent Locations and Movement Patterns

Term project for Cpts 475 Data Science

### Load necessary libraries and Dataset

```{r}
# Load required libraries
library(dplyr)
library(tidyr)
library(lubridate)

locations = read.csv('../data/all_locations.csv', header = TRUE, sep = ",")

head(locations)

```

**extract datetime element from data and create new table variables with extracted data. removed original datetime for extracted date and time data, and the first column 'instance' data.**

```{r}

location_summary <- locations %>%
  mutate(datetime = mdy_hm(datetime),
         date = as.Date(datetime),
         month = month(date),
         lat = round(lat, 4),
         long = round(long, 4)) %>% # probably can change the amount. I used it for avoiding duplication.
  group_by(lat, long, month) %>%
  summarise(staying_time = sum(as.numeric(difftime(max(datetime), min(datetime), units = "hours")))) %>%
  ungroup()

location_summary

```

### Identify the top 5 locations where the individual spends the most time each month

```{r}
top_locations <- location_summary %>%
  group_by(month) %>%
  arrange(desc(staying_time)) %>%
  slice_head(n = 5) %>%
  ungroup()

top_locations

# need to work on remove similar place
```

### Calculate the total time spent at each key location

```{r}

```
